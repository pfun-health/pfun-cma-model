<!DOCTYPE html>
<html>

<head>
    <title>WebRTC with WebSockets</title>
</head>

<body>
    <button id="start">Start</button>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const ws = new WebSocket("ws://localhost:8765");

            ws.addEventListener("open", function (event) {
                console.log("WebSocket connection opened:", event);

                // WebRTC Configuration
                const configuration = { iceServers: [{ urls: "stun:stun.l.google.com:19302" }] };
                const pc = new RTCPeerConnection(configuration);

                // Handle WebRTC events here
                // ...

                // Start button click event
                document.getElementById("start").addEventListener("click", function () {
                    // Send a query to the server
                    ws.send("Query example");

                    // Create WebRTC offer
                    pc.createOffer()
                        .then(offer => pc.setLocalDescription(offer))
                        .then(() => {
                            ws.send(JSON.stringify({ "offer": pc.localDescription }));
                        });
                });

                // Receive data from server
                ws.addEventListener("message", function (event) {
                    console.log("Received data:", event.data);

                    // Handle server data here
                    // ...
                });
            });
        });
    </script>
</body>

</html>