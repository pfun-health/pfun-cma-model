{% extends "base.html" %}
{% block title %}Run-at-Time WebSocket Example{% endblock %}

{% block head %}
{{ super() }}
{% endblock %}

<body>
  <header>
    {% block navheader %}
    {{ super() }}
    {% endblock %}
  </header>

  <div id="content">
    {% block content %}
    <h2>Run-at-Time WebSocket Demo</h2>
    <h3>Chart</h3>
    <div id="scatterPlotContainer">
      <canvas id="scatterPlot"></canvas>
    </div>
    <form id="runForm">

      <div class="form-row">
        <label for="t0" class="tooltip">t0 (0.0, 24.0):
          <span class="tooltiptext">Simulation start time (decimal hours).</span>
        </label>
        <input class="model-params" type="number" step="0.5" id="t0" name="t0" max="24.0" min="0" value="4" required>
      </div>

      <div class="form-row">
        <label for="t1" class="tooltip">t1 (0, 24.0):
          <span class="tooltiptext">Simulation end time (decimal hours).<br>Note: t1 must be greater than t0.</span>
        </label>
        <input class="model-params" type="number" step="0.5" id="t1" name="t1" max="24.0" min="0" value="20" required>
      </div>

      <div class="form-row">
        <label for="N" class="tooltip">N (1, 10000):
          <span class="tooltiptext">Number of points to simulate.<br>Note: N must be a positive integer.</span>
        </label>
        <input class="model-params" type="number" id="N" name="N" min="1" max="10000" value="100" required>
      </div>
      </head>

      <!-- Model Parameters: -->

      <h3>Model Parameters</h3>
      <div class="params-grid">
        {% for key, param in params.items() %}
        <div class="param-item">
          <label for="{{ key }}" class="tooltip">{{ key }}:
            <span class="tooltiptext">
              {{ param.description }}<br>
            </span>
          </label>
          <input class="model-params" type="range" step="0.05" id="{{ key }}" name="{{ key }}" value="{{ param.value }}"
            min="{{ param.min }}" max="{{ param.max }}" required>
        </div>
        {% endfor %}
      </div>

      <button type="submit">Send</button>
    </form>

    <div id="message-list">
      <div id="messages"></div>
    </div>

    <!-- Chart.js CDN -->
    <script src="{{ csp_hashes['chartjs']['url'] }}" nonce="{{ csp_hashes['chartjs']['nonce'] }}"
      crossorigin="anonymous"></script>
    <!-- Socket.IO CDN -->
    <!-- Note: Ensure you have the correct version matching your server -->
    <script src="{{ csp_hashes['socketio']['url'] }}" nonce="{{ csp_hashes['socketio']['nonce'] }}"
      crossorigin="anonymous"></script>

    <script src="{{ url_for('static', path='run-at-time.js') }}" nonce="{{ csp_hashes['run-at-time.js']['nonce'] }}"
      crossorigin="anonymous"></script>
    {% endblock %}
  </div>
</body>

</html>